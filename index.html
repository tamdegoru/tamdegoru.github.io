<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Home</title>
    <link rel="icon" href="images/logohata.png" type="image/x-icon">
    <!-- HTMX -->
    <script src="https://unpkg.com/htmx.org@1.9.12"></script>

    <!-- Головний CSS -->
    <link rel="stylesheet" href="css/index.css">
</head>
<body>

<!-- HEADER -->
<div 
    hx-get="partials/global.header.html"
    hx-trigger="load"
    hx-swap="outerHTML">
</div>

    <div 
    hx-get="partials/galery.galery.html"
    hx-trigger="load"
    hx-swap="outerHTML">
</div>
    
<!-- Підвантаження футера -->
<div 
    hx-get="partials/global.footer.html"
    hx-trigger="load"
    hx-swap="outerHTML">
</div>

<!-- JS -->

<script >

const init = async () => {
  console.log("Всі блоки завантажені. Імпортуємо скрипти...");
  try {
    const module = await import("js/global.footer.js");
    // Якщо у модулі є функція ініціалізації:
    // module.start(); 
  } catch (err) {
    console.error("Помилка завантаження модуля:", err);
  }
};

const partials = document.querySelectorAll('[hx-trigger="load"], [data-hx-trigger="load"]');
const totalPartials = partials.length;
let processedCount = 0;

// Якщо на сторінці взагалі немає динамічних блоків, запускаємо одразу
if (totalPartials === 0) {
  init();
} else {
  document.body.addEventListener("htmx:afterSettle", (event) => {
    // Перевіряємо, чи подія стосується одного з наших початкових запитів
    processedCount++;

    console.log(`Завантажено ${processedCount} з ${totalPartials}`);

    if (processedCount >= totalPartials) {
      init();
    }
  });

  // Додатковий захист: якщо запит завершився помилкою, теж рахуємо його, 
  // щоб сайт не "завис" у стані завантаження
  document.body.addEventListener("htmx:responseError", () => {
    processedCount++;
    if (processedCount >= totalPartials) init();
  });
}
</script>
    

</body>
</html>





















